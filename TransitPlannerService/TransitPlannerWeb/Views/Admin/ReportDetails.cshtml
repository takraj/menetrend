@model TransitPlannerWeb.ViewModels.ReportDetailsAdminModel
@{
    ViewBag.Title = "Bejelentés részletei";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2 class="report-details-title">Bejelentés részletei</h2>
<table class="report-details-table">
    <tr>
        <td class="report-property">Azonosító:</td>
        <td>@Html.Label(Model.Id.ToString())</td>
    </tr>
    <tr>
        <td class="report-property">Készült:</td>
        <td>@Html.Label(Model.Created.ToString(@"yyyy-MM-dd HH:mm"))</td>
    </tr>
    <tr>
        <td class="report-property">Érkezett:</td>
        <td>@Html.Label(Model.Received.ToString(@"yyyy-MM-dd HH:mm"))</td>
    </tr>
    <tr>
        <td class="report-property">Kategória:</td>
        <td>@Html.Label(Model.Category)</td>
    </tr>
    @if (Model.Location != null)
    {
        <tr>
            <td class="report-property">Megálló:</td>
            <td>@Html.Label(Model.Location.StopName)</td>
        </tr>
    }
    <tr>
        <td class="report-property">Üzenet:</td>
        <td>
            @Html.Raw(System.Text.RegularExpressions.Regex.Replace(Html.Encode(Model.Message), @"\r\n?|\n", "<br />"))
        </td>
    </tr>
    @if (Model.Location != null)
    {
        <tr>
            <td class="report-property">Térkép:</td>
            <td>
                <div id="map_embedded_canvas" class="map_embedded" />
            </td>
        </tr>
    }
</table>

@section sidebar {
    @Html.Partial("_AdminSidebar")
}

@if (Model.Location != null)
{
    @section scripts {
        <script type="text/javascript"
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDx0BPr9sy2ndglbnwYrwrMzXmU0fDoSG8&sensor=true">
        </script>

        <script type="text/javascript">
            window.onload = function () {
                var Model = JSON.parse("@Html.Raw(Json.Encode(Model))");

                var map = TUSZ.create_map("map_embedded_canvas", 47.5, 19.08);

                var marker = new google.maps.Marker({
                    map: map,
                    position: new google.maps.LatLng(Model.Location.Latitude, Model.Location.Longitude)
                });

                map.setCenter(marker.position);
            }
        </script>
    }
}